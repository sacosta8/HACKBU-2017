<!DOCTYPE html>
<html>
  <head>
    <title> WEBSITE NAME </title>
    <script src="static/javascript/kairos.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/p5.js/0.5.7/p5.js"></script>

  </head>
  <body>
    <h1> HELLO </h1>
    <p1> you like jazz? </p1>
    <p id="attributes"></p>
    <video id="video" width="640" height="480" autoplay></video>
    <button id="snap">Snap Photo</button>
    <canvas id="canvas" width="640" height="480"></canvas>
    <div id=percentHispanic>ayy</div>
    <div id=percentBlack>ayy2</div>
    <div id=percentAsian>ayy3</div>
    <div id=percentWhite>ayy4</div>
    <div id="hacker_picture"></div>




  </body>


  <script>
    var kairos = new Kairos("cd7690fd","32df39bf4f4e7d9882a9e6e9154ceaca");

      var canvas = document.getElementById('canvas');
      var context = canvas.getContext('2d');
      var video = document.getElementById('video');

      // Get access to the camera!
      if(navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
          navigator.mediaDevices.getUserMedia({ video: true }).then(function(stream) {
              video.src = window.URL.createObjectURL(stream);
              video.play();

          });
      }
      // Trigger photo take
      document.getElementById("snap").addEventListener("click", function() {
      console.log(context);
      context.drawImage(video, 0, 0, 640, 480);
      var image = canvas.toDataURL();
      //console.log(image);
      var options = { "selector" : "FULL"};
      kairos.detect(image, myDetectCallback, options);
      console.log(typeof image);


      });




      //console.log(kairos);
      // (1) set up your callback method
      function myDetectCallback(response)
      {
        console.log(typeof response)
        var obj = JSON.parse(response.responseText);

        //var json_data = JSON.stringify(response);
        //document.getElementById("percentHispanic").innerHTML = "hispanic: " + JSON.stringify(obj["images"][0]["faces"][0]["attributes"]["hispanic"]*100);
        //document.getElementById("percentBlack").innerHTML = "black: " + JSON.stringify(obj["images"][0]["faces"][0]["attributes"]["black"]*100);
        //document.getElementById("percentAsian").innerHTML = "asian: " + JSON.stringify(obj["images"][0]["faces"][0]["attributes"]["asian"]*100);
        //document.getElementById("percentWhite").innerHTML = "white: " + JSON.stringify(obj["images"][0]["faces"][0]["attributes"]["white"]*100);
        //console.log(Object.keys(obj["images"][0]["faces"][0]["attributes"]));


        //document.getElementById("percent").innerHTML = JSON.stringify(obj["images"][0]["face"]);


      }
      $.getJSON("static/hackers5.json", function(json) {
          //var obj = JSON.stringify(json);
          jsonDataMAIN = JSON.stringify(json["hackers"]);
          jsonDataMAIN = JSON.parse(jsonDataMAIN)
          jsonData = JSON.parse(JSON.stringify(Object.keys(json["hackers"]))); // this will show the info it in firebug console
          console.log(jsonData);
          console.log(jsonDataMAIN);


          for (var key in jsonData) {
            console.log(jsonData[key]);
            console.log(jsonDataMAIN[jsonData[key]]["pic"]);
            var hacker_picture = document.createElement("img");
            hacker_picture.src = jsonDataMAIN[jsonData[key]]["pic"];
            console.log(hacker_picture);
            document.getElementById("hacker_picture").append(hacker_picture);

            //console.log(jsonDataMAIN[jsonData[key]]["description"]);
          }
      }
    );


  </script>

<html>
